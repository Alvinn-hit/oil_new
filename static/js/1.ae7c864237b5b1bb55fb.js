webpackJsonp([1],{"+Zow":function(t,e,a){var n=a("rQ8G");"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);a("rjj0")("07faa9a6",n,!1)},"6RqM":function(t,e,a){"use strict";var n={props:{value:{default:!1}},data:function(){return{}},watch:{value:function(t){var e=this;!window.__errorFocus&&t&&(window.__errorFocus=!0,this.$el.scrollIntoView(),clearTimeout(this.timer),this.timer=setTimeout(function(){e.$emit("input",!1),window.__errorFocus=!1},1e3))}}},r=function(){var t=this.$createElement;return(this._self._c||t)("div",{staticClass:"error-focus",class:{error:this.value}},[this._t("default")],2)};r._withStripped=!0;var i={render:r,staticRenderFns:[]},o=i;var l=!1;var c=a("VU/8")(n,o,!1,function(t){l||a("+Zow")},"data-v-776eb880",null);c.options.__file="src\\components\\ErrorFocus.vue";e.a=c.exports},AdLt:function(t,e,a){var n=a("VGwz");"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);a("rjj0")("6faa9d42",n,!1)},LlAJ:function(t,e,a){"use strict";var n=function(){var t=this.$createElement;return(this._self._c||t)("div",{staticClass:"g-inline-field-item"},[this._t("default")],2)};n._withStripped=!0;var r={render:n,staticRenderFns:[]},i=r;var o=!1;var l=a("VU/8")({},i,!1,function(t){o||a("vHKS")},null,null);l.options.__file="src\\components\\Inline.vue";e.a=l.exports},SKGP:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("Xxa5"),r=a.n(n),i=(a("qONS"),a("UQTY")),o=a.n(i),l=(a("OgVB"),a("/Lyv")),c=a.n(l),s=a("exGp"),p=a.n(s),d=a("Dd8w"),m=a.n(d),u=a("JhKW"),f=a("rhdv"),g=a("YIB9"),A=a("GC8e"),v=a("QjXM"),h=a("XDRT"),D=a("pzWD"),b=a("6RqM"),_=a("bWRp"),y=a("LlAJ"),C=a("ScE3"),x=a("WUkm"),k=a("vLgD"),N={components:{Panel:u.a,Card:f.a,AuditItem:A.a,FieldItem:g.a,AuditGoodsItem:v.a,AuditTable:h.a,SubmitBtn:D.a,ErrorFocus:b.a,ActionModal:_.a,Inline:y.a,TextAvatar:C.a},data:function(){return{audit1Error:!1,audit2Error:!1}},computed:m()({},Object(x.b)(),Object(x.a)({moduleName:!0},["audit1"],["audit1comment"],["audit2"]),Object(x.c)("pageData"),{id:function(){return this.pageData?this.pageData.contractId:""},goods:function(){var t=this.pageData,e=[];return t&&(t.buyGoods&&(e=e.concat(t.buyGoods)),t.sellGoods&&(e=e.concat(t.sellGoods))),e},contractTitle:function(){var t=this.pageData,e="";return t.buyContent&&(e+="上"),t.sellContent&&(e+="下"),e?e+"游":""}}),watch:{pageData:function(){document.title=this.pageData.pageTitle||"石油系统"}},methods:{onSubmit:function(t){var e=this;return p()(r.a.mark(function a(){var n,i,l,s,p,d,m;return r.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(n=e.moduleName,"check"!==(i=e.actionName)){a.next=44;break}if("check2"!==n||e.audit1||"1"!==t){a.next=7;break}e.audit1Error=Date.now(),e.$toptips("请选择是否启用额度流程"),a.next=44;break;case 7:if(e.audit2){a.next=12;break}e.audit2Error=Date.now(),e.$toptips("请输入本次审核意见"),a.next=44;break;case 12:return l="1"===t?"通过":"驳回",a.next=15,c.a.confirm("确定要"+l+"本次审核吗？","").catch(function(){return!1});case 15:if(!a.sent){a.next=44;break}return o.a.open(),a.next=20,Object(k.b)("/"+n+"/save",{obj:{remark:e.audit2,check_id:e.pageData.checkId,checkStatus:t}});case 20:if(s=a.sent,p=s.success,d=s.msg,!p){a.next=42;break}if(m={success:1},"1"!==t||"0"!==e.audit1){a.next=29;break}return a.next=28,Object(k.b)("/quota/save",{contract_id:e.pageData.contractId,project_id:e.pageData.projectId,is_main:e.pageData.isMain});case 28:m=a.sent;case 29:return o.a.close(),a.next=32,c.a.alert("审核提交成功!","");case 32:if("1"!==t||"1"!==e.audit1&&m.success){a.next=39;break}if("0"!==e.audit1||m.success){a.next=36;break}return a.next=36,c.a.alert(m.msg,"");case 36:e.$router.replace({path:"/"+n+"/"+i+"/add-price",query:{id:e.pageData.contractId,detail_id:e.pageData.detailId}}),a.next=40;break;case 39:e.$router.replace({path:"/"+n+"/detail",query:{detail_id:e.pageData.detailId,__force:!0}});case 40:a.next=44;break;case 42:return a.next=44,c.a.alert(d,"").then(function(t){window.location.href="/site/index"});case 44:case"end":return a.stop()}},a,e)}))()}}},I=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.pageData?a("div",[a("panel",{attrs:{title:"项目信息"}},[a("card",[a("field-item",{attrs:{label:"项目编码",content:t.pageData.projectCode}}),t._v(" "),a("field-item",{attrs:{label:"项目类型",content:t.pageData.projectTypeName}}),t._v(" "),a("field-item",{attrs:{label:"购销信息",content:t.pageData.buySellDesc}}),t._v(" "),a("field-item",{attrs:{label:"合同类型",content:t.pageData.contractTypeName}}),t._v(" "),a("field-item",{attrs:{label:"代理模式",content:t.pageData.agentTypeName}}),t._v(" "),t.pageData.agentName||t.pageData.prevParterName?a("div",{staticClass:"g-dotted-split"}):t._e(),t._v(" "),a("field-item",{attrs:{label:"采购代理商",content:t.pageData.agentName}}),t._v(" "),a("field-item",{attrs:{label:"上游合作方",content:t.pageData.prevPartnerName}}),t._v(" "),a("field-item",{attrs:{label:"下游合作方",content:t.pageData.nextPartnerName}}),t._v(" "),a("div",{staticClass:"g-dotted-split"}),t._v(" "),a("field-item",{attrs:{label:"交易主体",content:t.pageData.corporationName}})],1)],1),t._v(" "),a("panel",{attrs:{title:"交易明细",type:"link",href:{path:"/"+t.moduleName+"/"+t.actionName+"/goods",query:{id:t.id}}}},t._l(t.goods,function(e){return e.name?a("card",{key:e.id},[a("audit-goods-item",{attrs:{name:e.name,avatar:e.avatar,blue:"2"==e.type,quantity:e.quantityName,price:e.price}})],1):t._e()})),t._v(" "),t.pageData.buyFormula||t.pageData.sellFormula?a("panel",{attrs:{title:"计价公式"}},[t.pageData.buyFormula&&t.pageData.buyContract&&2==t.pageData.buyContract.price_type?a("card",{staticClass:"simple-card"},[a("h1",[t._v("采购计价公式")]),t._v(" "),a("p",[t._v(t._s(t.pageData.buyFormula))])]):t._e(),t._v(" "),t.pageData.sellFormula&&t.pageData.sellContract&&2==t.pageData.sellContract.price_type?a("card",{staticClass:"simple-card"},[a("h1",[t._v("销售计价公式")]),t._v(" "),a("p",[t._v(t._s(t.pageData.sellFormula))])]):t._e()],1):t._e(),t._v(" "),t.contractTitle?a("panel",{attrs:{type:"link",title:"合同条款",href:{path:"/"+t.moduleName+"/"+t.actionName+"/contract",query:{id:t.id}}}}):t._e(),t._v(" "),t.pageData.agentDetails.length?a("panel",{attrs:{type:"link",title:"代理手续费",href:{path:"/"+t.moduleName+"/"+t.actionName+"/agentfee",query:{id:t.id}}}}):t._e(),t._v(" "),t.contractTitle?a("panel",{attrs:{title:"收付款计划"}},[a("card",[t.pageData.prevPayments?a("audit-table",{attrs:{avatar:"付"}},[a("template",{slot:"header"},[a("td",{attrs:{width:"80"}},[t._v("预计时间")]),t._v(" "),a("td",{attrs:{width:"100"}},[t._v("付款类别")]),t._v(" "),a("td",[t._v("金额")]),t._v(" "),a("td",{attrs:{width:"50"}},[t._v("备注")])]),t._v(" "),a("template",{slot:"body"},t._l(t.pageData.prevPayments,function(e){return a("tr",[a("td",[t._v(t._s(e.date))]),t._v(" "),a("td",[t._v(t._s(e.typeName))]),t._v(" "),a("td",[t._v(t._s(e.price))]),t._v(" "),a("td",[a("action-modal",{attrs:{value:e.remark}})],1)])}))],2):t._e(),t._v(" "),t.pageData.nextPayments?a("audit-table",{staticClass:"table-split",attrs:{avatar:"收",blue:!0}},[a("template",{slot:"header"},[a("td",{attrs:{width:"80"}},[t._v("预计时间")]),t._v(" "),a("td",{attrs:{width:"100"}},[t._v("收款类别")]),t._v(" "),a("td",[t._v("金额")]),t._v(" "),a("td",{attrs:{width:"50"}},[t._v("备注")])]),t._v(" "),a("template",{slot:"body"},t._l(t.pageData.nextPayments,function(e){return a("tr",[a("td",[t._v(t._s(e.date))]),t._v(" "),a("td",[t._v(t._s(e.typeName))]),t._v(" "),a("td",[t._v(t._s(e.price))]),t._v(" "),a("td",[a("action-modal",{attrs:{value:e.remark}})],1)])}))],2):t._e(),t._v(" "),a("div",{staticClass:"g-dotted-split"}),t._v(" "),t.pageData.attachments?a("div",["check"===t.actionName?a("field-item",{attrs:{type:"link",href:{path:"/"+t.moduleName+"/"+t.actionName+"/attachment",query:{id:t.id}},label:"项目预算表",content:"查看"}}):t._e(),t._v(" "),"detail"===t.actionName?a("field-item",{attrs:{type:"link",href:{path:"/"+t.moduleName+"/"+t.actionName+"/attachment",query:{detail_id:t.pageData.detailId}},label:"项目预算表",content:"查看"}}):t._e()],1):t._e()],1)],1):t._e(),t._v(" "),a("panel",{attrs:{title:"创建人信息"}},[a("card",[a("field-item",{attrs:{label:"创建人",content:t.pageData.creator}}),t._v(" "),a("field-item",{attrs:{label:"创建时间",content:t.pageData.create_time}}),t._v(" "),a("field-item",{attrs:{label:"修改人",content:t.pageData.updater}}),t._v(" "),a("field-item",{attrs:{label:"修改时间",content:t.pageData.update_time}})],1)],1),t._v(" "),t.pageData.quotas.length?a("panel",{attrs:{title:"额度管理"}},t._l(t.pageData.quotas,function(e){return a("card",{key:e.id},[a("div",{staticClass:"quota-item"},[a("text-avatar",{attrs:{blue:e.isBlue}},[t._v(t._s(e.icon))]),t._v(" "),a("div",{staticClass:"quota-info"},[a("p",[t._v("占用对象： "+t._s(e.name))]),t._v(" "),a("p",[t._v("占用金额： "+t._s(e.price))]),t._v(" "),a("p",[t._v("备注： "+t._s(e.comment||"无"))])])],1)])})):t._e(),t._v(" "),t.pageData.checkHistory.length?a("panel",{attrs:{title:"审核历史记录",type:"link",href:{path:"/"+t.moduleName+"/"+t.actionName+"/history",query:{detail_id:t.pageData.detailId}}}}):t._e(),t._v(" "),"check2"==t.moduleName&&"check"==t.actionName?[a("panel",{attrs:{title:"额度管理"}},[a("card",[a("error-focus",{model:{value:t.audit1Error,callback:function(e){t.audit1Error=e},expression:"audit1Error"}},[a("audit-item",{attrs:{title:"是否启用额度流程"},model:{value:t.audit1,callback:function(e){t.audit1=e},expression:"audit1"}})],1)],1)],1)]:t._e(),t._v(" "),"detail"!=t.actionName?a("panel",{attrs:{title:"本次审核意见"}},[a("card",{attrs:{topBorder:1}},[a("error-focus",{model:{value:t.audit2Error,callback:function(e){t.audit2Error=e},expression:"audit2Error"}},[a("audit-item",{attrs:{type:"comment",placeholder:"请输入本次审核意见"},model:{value:t.audit2,callback:function(e){t.audit2=e},expression:"audit2"}})],1)],1)],1):t._e(),t._v(" "),"detail"!=t.actionName?a("submit-btn",{attrs:{okText:"通过",cancelText:"驳回"},on:{okHandle:function(e){t.onSubmit("1")},cancelHandle:function(e){t.onSubmit("-1")}}}):t._e()],2):a("div")};I._withStripped=!0;var w={render:I,staticRenderFns:[]},T=w;var E=!1;var F=a("VU/8")(N,T,!1,function(t){E||a("YaDd")},"data-v-696330a7",null);F.options.__file="src\\router\\check\\check.vue";e.default=F.exports},VGwz:function(t,e,a){(t.exports=a("FZ+f")(!0)).push([t.i,"\n.table-split[data-v-e12f972a]{\r\nmargin-top: 15px;\n}\n.simple-card h1[data-v-e12f972a]{\r\n    font-weight: normal; \r\n    font-size: 14px;\n}\n.simple-card p[data-v-e12f972a]{\r\n    font-size: 12px;\r\n    color: #949494;\n}\r\n","",{version:3,sources:["C:/Users/alaba/codes/oil_new/protected/h5/src/router/check13/src/router/check13/check13.vue"],names:[],mappings:";AA+OA;AACA,iBAAA;CACA;AAEA;IACA,oBAAA;IACA,gBAAA;CACA;AACA;IACA,gBAAA;IACA,eAAA;CACA",file:"check13.vue",sourcesContent:['<template>\r\n  <div v-if="pageData">\r\n    <panel title="付款信息">\r\n      <card>\r\n        <field-item label="付款申请编号" :content="pageData.applyId"/>\r\n        <field-item label="付 款  金   额" :content="pageData.amount "/>\r\n        <field-item label="已实付金额" :content="pageData.contractPaiedAmount "/>\r\n        <field-item label="用            途" :content="pageData.subjectName "/>\r\n        <field-item label="付  款 原 因" :content="pageData.payRemark "/>\r\n      </card>\r\n      <card type="link" :href="{path:\'/\'+moduleName+\'/\'+actionName+\'/payments\', query: {id: pageData.applyId}}" v-if="pageData.payDetails.length && (pageData.applyType === 11 || pageData.applyType === \'11\')">付款计划 ( {{pageData.payDetails.length}} )</card>\r\n      <card v-if="pageData.payDetails.length === 0 && (pageData.applyType === 11 || pageData.applyType === \'11\')">付款计划 ( 0 )</card>\r\n\r\n      <card type="link" :href="{path:\'/\'+moduleName+\'/\'+actionName+\'/contract-files\', query: {id: pageData.applyId}}" v-if="pageData.contractFiles.length&&actionName===\'check\'">合同附件 ( {{pageData.contractFiles.length}} )</card>\r\n      <card type="link" :href="{path:\'/\'+moduleName+\'/\'+actionName+\'/contract-files\', query: {detail_id:pageData.detailId}}" v-if="pageData.contractFiles.length&&actionName===\'detail\'">合同附件 ( {{pageData.contractFiles.length}} )</card>\r\n      <card v-if="pageData.contractFiles.length === 0 && (pageData.applyType === 11 || pageData.applyType === \'11\')">合同附件 ( 0 )</card>\r\n      <card type="link" :href="{path:\'/\'+moduleName+\'/\'+actionName+\'/attachments\', query: {id: pageData.applyId}}" v-if="pageData.attachments.length&&actionName===\'check\'">付款附件 ( {{pageData.attachments.length}} )</card>\r\n      <card type="link" :href="{path:\'/\'+moduleName+\'/\'+actionName+\'/attachments\', query: {detail_id:pageData.detailId}}" v-if="pageData.attachments.length&&actionName===\'detail\'">付款附件 ( {{pageData.attachments.length}} )</card>\r\n      <card v-if="pageData.attachments.length===0">付款附件 ( 0 )</card>\r\n      <card>\r\n        <field-item  v-if="pageData.applyType === 11 || pageData.applyType === \'11\'" label="是否对接保理" :content="pageData.isFactoring" force="1"/>\r\n        <field-item  v-if="pageData.applyType === 11 || pageData.applyType === \'11\'" label="本次保理金额" :content="pageData.factoringAmount" force="1"/>\r\n        <field-item  v-if="pageData.applyType === 11 || pageData.applyType === \'11\'" label="资金对接编号" :content="pageData.factoringCodeFund" />\r\n        <field-item  v-if="pageData.applyType === 11 || pageData.applyType === \'11\'" label="保理对接编号" :content="pageData.factoringCode" />\r\n        <field-item label="付款合同类别" :content="pageData.subContractType" force="1"/>\r\n        <field-item label="付款合同编号" :content="pageData.subContractCode" force="1"/>\r\n      </card>\r\n      <card>\r\n        <field-item label="收款单位" :content="pageData.payee"/>\r\n        <field-item label="收款账户名" :content="pageData.accountName"/>\r\n        <field-item label="开 户 银 行" :content="pageData.bank "/>\r\n        <field-item label="银 行 账 号" :content="pageData.account "/>\r\n      </card>\r\n    </panel>\r\n    <panel v-if="pageData.multipleContract" title="合同信息" type="link" :href="{path:\'/\'+moduleName+\'/\'+actionName+\'/contract\', query: {id: pageData.applyId}}">\r\n      <card>\r\n        <field-item label="交易主体" :content="pageData.corporationName"/>\r\n        <div class="g-dotted-split"></div>\r\n        <field-item v-for="item in pageData.multipleContract" :key="item.contractCode + item.projectCode" label="合同编号" :content="item.contractCode"/>\r\n      </card>\r\n    </panel>\r\n    <panel v-else-if="pageData.singleContract" title="合同信息">\r\n      <card>\r\n        <field-item label="交易主体" :content="pageData.corporationName"/>\r\n        <field-item label="合作方" :content="pageData.singleContract.partnerName"/>\r\n        <field-item label="项目编号" :content="pageData.singleContract.projectCode"/>\r\n        <field-item label="项目类型" :content="pageData.singleContract.projectTypeName "/>\r\n        <field-item label="合同编号" :content="pageData.singleContract.contractCode"/>\r\n        <field-item label="合同类型" :content="pageData.singleContract.contractTypeName"/>\r\n      </card>\r\n    </panel>\r\n    <panel v-else-if="pageData.projectInfo" title="项目信息">\r\n      <card>\r\n        <field-item label="交易主体" :content="pageData.corporationName"/>\r\n        <field-item label="合作方" :content="pageData.projectInfo.partnerName"/>\r\n        <field-item label="项目编号" :content="pageData.projectInfo.projectCode"/>\r\n        <field-item label="项目类型" :content="pageData.projectInfo.projectTypeName "/>\r\n      </card>\r\n    </panel>\r\n    <card v-else>\r\n      <field-item label="交易主体" :content="pageData.corporationName"/>\r\n    </card>\r\n    <panel title="风险提示">\r\n      <card>\r\n        <field-item v-for="item in pageData.payExtra" :key="item.name" :label="item.name" :content="item.value"/>\r\n      </card>\r\n    </panel>\r\n    <panel title="审核历史记录" v-if="pageData.checkHistory.length > 0" type="link" :href="{path:\'/\'+moduleName+\'/\'+actionName+\'/history\', query: {detail_id: pageData.detailId}}"></panel>\r\n    <template v-if="actionName!=\'detail\'">\r\n    <panel title="本次审核意见" v-if="pageData.auditOptions">\r\n       <card v-for="(item, index) in pageData.auditOptions" :key="item.name">\r\n        <error-focus v-model="auditError[index]" >\r\n            <audit-item :title="(index+1) + \'.\' + item.name" :value="audit[index].value" @input="auditInput(index, \'value\', $event)"></audit-item>\r\n        </error-focus>\r\n        <error-focus v-model="auditError[index]">\r\n            <audit-item type="input" :value="audit[index].comment" @input="auditInput(index,\'comment\', $event)"></audit-item>\r\n        </error-focus>\r\n       </card>\r\n      <card :topBorder="1" >\r\n        <error-focus v-model="auditCommentError">\r\n          <audit-item type="comment" placeholder="请输入本次审核意见" v-model="auditComment"/>\r\n        </error-focus>\r\n      </card>\r\n    </panel>\r\n    <submit-btn okText="通过" cancelText="驳回" @okHandle="onSubmit(\'1\')" @cancelHandle="onSubmit(\'-1\')"/>\r\n    </template>\r\n      </div>\r\n</template>\r\n\r\n<script>\r\nimport { Indicator, MessageBox } from \'mint-ui\'\r\nimport Panel from \'@/components/Panel\'\r\nimport Card from \'@/components/Card\'\r\nimport FieldItem from \'@/components/FieldItem\'\r\nimport AuditItem from \'@/components/AuditItem\'\r\nimport AuditGoodsItem from \'@/components/AuditGoodsItem\'\r\nimport AuditTable from \'@/components/AuditTable\'\r\nimport SubmitBtn from \'@/components/SubmitBtn\'\r\nimport ErrorFocus from \'@/components/ErrorFocus\'\r\nimport ActionModal from \'@/components/ActionModal\'\r\nimport Inline from \'@/components/Inline\'\r\nimport mapVmodel, {mapBase, mapStatePlus} from \'@/utils/mapVmodel\'\r\nimport {post} from \'@/utils/request\'\r\n\r\nexport default {\r\n  components: {\r\n    Panel,\r\n    Card,\r\n    AuditItem,\r\n    FieldItem,\r\n    AuditGoodsItem,\r\n    AuditTable,\r\n    SubmitBtn,\r\n    ErrorFocus,\r\n    ActionModal,\r\n    Inline\r\n  },\r\n  data () {\r\n    return {\r\n    }\r\n  },\r\n  computed: {\r\n    ...mapBase(),\r\n    ...mapVmodel({moduleName: true}, [\'audit\'], [\'auditError\'], [\'auditComment\'], [\'auditCommentError\']),\r\n    ...mapStatePlus(\'pageData\'),\r\n    id () {\r\n      return this.pageData ? this.pageData.contractId : \'\'\r\n    },\r\n    goods () {\r\n      let {pageData} = this\r\n      let goods = []\r\n      if (pageData) {\r\n        if (pageData.buyGoods) {\r\n          goods = goods.concat(pageData.buyGoods)\r\n        }\r\n        if (pageData.shellGoods) {\r\n          goods = goods.concat(pageData.shellGoods)\r\n        }\r\n      }\r\n      return goods\r\n    },\r\n    contractTitle () {\r\n      let {pageData} = this\r\n      let prefix = \'\'\r\n      if (pageData.buyContent) {\r\n        prefix += \'上\'\r\n      }\r\n      if (pageData.shellContent) {\r\n        prefix += \'下\'\r\n      }\r\n      if (!prefix) {\r\n        return \'\'\r\n      }\r\n      return prefix + \'游\'\r\n    }\r\n  },\r\n  watch: {\r\n    pageData () {\r\n      document.title = this.pageData.pageTitle || \'石油系统\'\r\n    }\r\n  },\r\n  methods: {\r\n    auditInput (index, field, value) {\r\n      let tmp = this.audit[index]\r\n      tmp[field] = value\r\n      this.audit.splice(index, 1, tmp)\r\n      this.$store.commit(`${this.moduleName}/update`, {field: \'audit\', value: this.audit})\r\n    },\r\n    async onSubmit (status) {\r\n      // 风控审核\r\n      let {moduleName, actionName} = this\r\n      if (moduleName === \'check13\' && actionName === \'check\') {\r\n        let errorMsgs = []\r\n        let failed = false\r\n        let submitData = {\r\n          items: [],\r\n          checkStatus: status,\r\n          check_id: this.pageData.checkId,\r\n          detail_id: this.pageData.detailId\r\n        }\r\n        this.pageData.auditOptions.find((opt, i) => {\r\n          let v = this.audit[i]\r\n          if (v.value === \'\') {\r\n            failed = true\r\n            // this.$set(this.auditError, i, new Date().getTime())\r\n            errorMsgs.push(\'请选择\' + opt.name)\r\n            // this.$toptips(\'请选择\' + opt.name)\r\n            // return true\r\n          } else if (v.value === \'0\' && v.comment === \'\') {\r\n            failed = true\r\n            // this.$set(this.auditError, i, new Date().getTime())\r\n            errorMsgs.push(opt.name + \'：选择否，备注项必填；\')\r\n            // this.$toptips(\'请填写备注\')\r\n            // return true\r\n          } else {\r\n            submitData.items.push({\r\n              name: opt.name,\r\n              displayValue: v.value === \'1\' ? \'是\' : \'否\',\r\n              value: v.value,\r\n              remark: v.comment\r\n            })\r\n          }\r\n        })\r\n        if (this.auditComment === \'\') {\r\n          this.$store.commit(`${moduleName}/update`, {field: \'auditCommentError\', value: new Date().getTime()})\r\n          // this.$toptips(\'请输入本次审核意见\')\r\n          errorMsgs.push(\'请输入本次审核意见\')\r\n          failed = true\r\n        } else {\r\n          submitData.remark = this.auditComment\r\n        }\r\n        if (failed) {\r\n          for (let i = 0; i < errorMsgs.length; i++) {\r\n            errorMsgs[i] = (i + 1) + \'.\' + errorMsgs[i]\r\n          }\r\n          let thisMsg = errorMsgs.join(\'<br>\')\r\n          this.$toptips(thisMsg)\r\n          return true\r\n        }\r\n        if (!failed) {\r\n          let action = await MessageBox.confirm(`确定要${status === \'-1\' ? \'驳回\' : \'通过\'}本次审核吗?`, \'\').catch(() => false)\r\n          if (action) {\r\n            Indicator.open()\r\n            let {success, msg} = await post(`/check13/save`, {data: submitData})\r\n            Indicator.close()\r\n            if (!success) {\r\n              this.$toptips(msg)\r\n            } else {\r\n              await MessageBox.alert(\'提交成功!\', \'\')\r\n              this.$router.replace({ path: `/${this.moduleName}/detail`, query: {detail_id: this.pageData.detailId, __force: true} })\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n<\/script>\r\n\r\n<style scoped>\r\n.table-split{\r\nmargin-top: 15px;\r\n}\r\n.simple-card{\r\n  h1{\r\n    font-weight: normal; \r\n    font-size: 14px;\r\n  }\r\n  p{\r\n    font-size: 12px;\r\n    color: #949494;\r\n  }\r\n}\r\n</style>\r\n'],sourceRoot:""}])},YaDd:function(t,e,a){var n=a("shcg");"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);a("rjj0")("0a31c5fe",n,!1)},bWRp:function(t,e,a){"use strict";a("OgVB");var n=a("/Lyv"),r=a.n(n),i={props:{value:{default:""},text:{default:"查看"}},methods:{doTap:function(){this.value&&r.a.alert(this.value,"备注")}}},o=function(){var t=this,e=t.$createElement;return(t._self._c||e)("span",{staticClass:"action-modal",class:{disabled:!t.value},on:{click:function(e){e.stopPropagation(),t.doTap(e)}}},[t._v("\r\n  "+t._s(t.text)+"\r\n")])};o._withStripped=!0;var l={render:o,staticRenderFns:[]},c=l;var s=!1;var p=a("VU/8")(i,c,!1,function(t){s||a("sDsX")},"data-v-68736a92",null);p.options.__file="src\\components\\ActionModal.vue";e.a=p.exports},hkk0:function(t,e,a){(t.exports=a("FZ+f")(!0)).push([t.i,"\n.action-modal[data-v-68736a92]{\r\n  color: #0066FF;\r\n  text-decoration: underline;\n}\n.action-modal.disabled[data-v-68736a92]{\r\n    text-decoration: none;\r\n    color: #cccccc;\n}\r\n","",{version:3,sources:["C:/Users/alaba/codes/oil_new/protected/h5/src/components/src/components/ActionModal.vue"],names:[],mappings:";AAsBA;EACA,eAAA;EACA,2BAAA;CAKA;AAJA;IACA,sBAAA;IACA,eAAA;CACA",file:"ActionModal.vue",sourcesContent:["<template>\r\n<span class=\"action-modal\" :class=\"{disabled: !value}\" @click.stop=\"doTap\">\r\n  {{text}}\r\n</span>\r\n</template>\r\n<script>\r\nimport { MessageBox } from 'mint-ui'\r\n\r\nexport default {\r\n  props: {\r\n    value: {default: ''},\r\n    text: {default: '查看'}\r\n  },\r\n  methods: {\r\n    doTap () {\r\n      if (this.value) {\r\n        MessageBox.alert(this.value, '备注')\r\n      }\r\n    }\r\n  }\r\n}\r\n<\/script>\r\n<style scoped>\r\n.action-modal{\r\n  color: #0066FF;\r\n  text-decoration: underline;\r\n  &.disabled{\r\n    text-decoration: none;\r\n    color: #cccccc;\r\n  }\r\n}\r\n</style>\r\n"],sourceRoot:""}])},lIq8:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("Xxa5"),r=a.n(n),i=(a("qONS"),a("UQTY")),o=a.n(i),l=(a("OgVB"),a("/Lyv")),c=a.n(l),s=a("exGp"),p=a.n(s),d=a("Dd8w"),m=a.n(d),u=a("JhKW"),f=a("rhdv"),g=a("YIB9"),A=a("GC8e"),v=a("QjXM"),h=a("XDRT"),D=a("pzWD"),b=a("6RqM"),_=a("bWRp"),y=a("LlAJ"),C=a("WUkm"),x=a("vLgD"),k={components:{Panel:u.a,Card:f.a,AuditItem:A.a,FieldItem:g.a,AuditGoodsItem:v.a,AuditTable:h.a,SubmitBtn:D.a,ErrorFocus:b.a,ActionModal:_.a,Inline:y.a},data:function(){return{}},computed:m()({},Object(C.b)(),Object(C.a)({moduleName:!0},["audit"],["auditError"],["auditComment"],["auditCommentError"]),Object(C.c)("pageData"),{id:function(){return this.pageData?this.pageData.contractId:""},goods:function(){var t=this.pageData,e=[];return t&&(t.buyGoods&&(e=e.concat(t.buyGoods)),t.shellGoods&&(e=e.concat(t.shellGoods))),e},contractTitle:function(){var t=this.pageData,e="";return t.buyContent&&(e+="上"),t.shellContent&&(e+="下"),e?e+"游":""}}),watch:{pageData:function(){document.title=this.pageData.pageTitle||"石油系统"}},methods:{auditInput:function(t,e,a){var n=this.audit[t];n[e]=a,this.audit.splice(t,1,n),this.$store.commit(this.moduleName+"/update",{field:"audit",value:this.audit})},onSubmit:function(t){var e=this;return p()(r.a.mark(function a(){var n,i,l,s,p,d,m,u,f,g;return r.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(n=e.moduleName,i=e.actionName,"check13"!==n||"check"!==i){a.next=31;break}if(l=[],s=!1,p={items:[],checkStatus:t,check_id:e.pageData.checkId,detail_id:e.pageData.detailId},e.pageData.auditOptions.find(function(t,a){var n=e.audit[a];""===n.value?(s=!0,l.push("请选择"+t.name)):"0"===n.value&&""===n.comment?(s=!0,l.push(t.name+"：选择否，备注项必填；")):p.items.push({name:t.name,displayValue:"1"===n.value?"是":"否",value:n.value,remark:n.comment})}),""===e.auditComment?(e.$store.commit(n+"/update",{field:"auditCommentError",value:(new Date).getTime()}),l.push("请输入本次审核意见"),s=!0):p.remark=e.auditComment,!s){a.next=12;break}for(d=0;d<l.length;d++)l[d]=d+1+"."+l[d];return m=l.join("<br>"),e.$toptips(m),a.abrupt("return",!0);case 12:if(s){a.next=31;break}return a.next=15,c.a.confirm("确定要"+("-1"===t?"驳回":"通过")+"本次审核吗?","").catch(function(){return!1});case 15:if(!a.sent){a.next=31;break}return o.a.open(),a.next=20,Object(x.b)("/check13/save",{data:p});case 20:if(u=a.sent,f=u.success,g=u.msg,o.a.close(),f){a.next=28;break}e.$toptips(g),a.next=31;break;case 28:return a.next=30,c.a.alert("提交成功!","");case 30:e.$router.replace({path:"/"+e.moduleName+"/detail",query:{detail_id:e.pageData.detailId,__force:!0}});case 31:case"end":return a.stop()}},a,e)}))()}}},N=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.pageData?a("div",[a("panel",{attrs:{title:"付款信息"}},[a("card",[a("field-item",{attrs:{label:"付款申请编号",content:t.pageData.applyId}}),t._v(" "),a("field-item",{attrs:{label:"付 款  金   额",content:t.pageData.amount}}),t._v(" "),a("field-item",{attrs:{label:"已实付金额",content:t.pageData.contractPaiedAmount}}),t._v(" "),a("field-item",{attrs:{label:"用            途",content:t.pageData.subjectName}}),t._v(" "),a("field-item",{attrs:{label:"付  款 原 因",content:t.pageData.payRemark}})],1),t._v(" "),!t.pageData.payDetails.length||11!==t.pageData.applyType&&"11"!==t.pageData.applyType?t._e():a("card",{attrs:{type:"link",href:{path:"/"+t.moduleName+"/"+t.actionName+"/payments",query:{id:t.pageData.applyId}}}},[t._v("付款计划 ( "+t._s(t.pageData.payDetails.length)+" )")]),t._v(" "),0!==t.pageData.payDetails.length||11!==t.pageData.applyType&&"11"!==t.pageData.applyType?t._e():a("card",[t._v("付款计划 ( 0 )")]),t._v(" "),t.pageData.contractFiles.length&&"check"===t.actionName?a("card",{attrs:{type:"link",href:{path:"/"+t.moduleName+"/"+t.actionName+"/contract-files",query:{id:t.pageData.applyId}}}},[t._v("合同附件 ( "+t._s(t.pageData.contractFiles.length)+" )")]):t._e(),t._v(" "),t.pageData.contractFiles.length&&"detail"===t.actionName?a("card",{attrs:{type:"link",href:{path:"/"+t.moduleName+"/"+t.actionName+"/contract-files",query:{detail_id:t.pageData.detailId}}}},[t._v("合同附件 ( "+t._s(t.pageData.contractFiles.length)+" )")]):t._e(),t._v(" "),0!==t.pageData.contractFiles.length||11!==t.pageData.applyType&&"11"!==t.pageData.applyType?t._e():a("card",[t._v("合同附件 ( 0 )")]),t._v(" "),t.pageData.attachments.length&&"check"===t.actionName?a("card",{attrs:{type:"link",href:{path:"/"+t.moduleName+"/"+t.actionName+"/attachments",query:{id:t.pageData.applyId}}}},[t._v("付款附件 ( "+t._s(t.pageData.attachments.length)+" )")]):t._e(),t._v(" "),t.pageData.attachments.length&&"detail"===t.actionName?a("card",{attrs:{type:"link",href:{path:"/"+t.moduleName+"/"+t.actionName+"/attachments",query:{detail_id:t.pageData.detailId}}}},[t._v("付款附件 ( "+t._s(t.pageData.attachments.length)+" )")]):t._e(),t._v(" "),0===t.pageData.attachments.length?a("card",[t._v("付款附件 ( 0 )")]):t._e(),t._v(" "),a("card",[11===t.pageData.applyType||"11"===t.pageData.applyType?a("field-item",{attrs:{label:"是否对接保理",content:t.pageData.isFactoring,force:"1"}}):t._e(),t._v(" "),11===t.pageData.applyType||"11"===t.pageData.applyType?a("field-item",{attrs:{label:"本次保理金额",content:t.pageData.factoringAmount,force:"1"}}):t._e(),t._v(" "),11===t.pageData.applyType||"11"===t.pageData.applyType?a("field-item",{attrs:{label:"资金对接编号",content:t.pageData.factoringCodeFund}}):t._e(),t._v(" "),11===t.pageData.applyType||"11"===t.pageData.applyType?a("field-item",{attrs:{label:"保理对接编号",content:t.pageData.factoringCode}}):t._e(),t._v(" "),a("field-item",{attrs:{label:"付款合同类别",content:t.pageData.subContractType,force:"1"}}),t._v(" "),a("field-item",{attrs:{label:"付款合同编号",content:t.pageData.subContractCode,force:"1"}})],1),t._v(" "),a("card",[a("field-item",{attrs:{label:"收款单位",content:t.pageData.payee}}),t._v(" "),a("field-item",{attrs:{label:"收款账户名",content:t.pageData.accountName}}),t._v(" "),a("field-item",{attrs:{label:"开 户 银 行",content:t.pageData.bank}}),t._v(" "),a("field-item",{attrs:{label:"银 行 账 号",content:t.pageData.account}})],1)],1),t._v(" "),t.pageData.multipleContract?a("panel",{attrs:{title:"合同信息",type:"link",href:{path:"/"+t.moduleName+"/"+t.actionName+"/contract",query:{id:t.pageData.applyId}}}},[a("card",[a("field-item",{attrs:{label:"交易主体",content:t.pageData.corporationName}}),t._v(" "),a("div",{staticClass:"g-dotted-split"}),t._v(" "),t._l(t.pageData.multipleContract,function(t){return a("field-item",{key:t.contractCode+t.projectCode,attrs:{label:"合同编号",content:t.contractCode}})})],2)],1):t.pageData.singleContract?a("panel",{attrs:{title:"合同信息"}},[a("card",[a("field-item",{attrs:{label:"交易主体",content:t.pageData.corporationName}}),t._v(" "),a("field-item",{attrs:{label:"合作方",content:t.pageData.singleContract.partnerName}}),t._v(" "),a("field-item",{attrs:{label:"项目编号",content:t.pageData.singleContract.projectCode}}),t._v(" "),a("field-item",{attrs:{label:"项目类型",content:t.pageData.singleContract.projectTypeName}}),t._v(" "),a("field-item",{attrs:{label:"合同编号",content:t.pageData.singleContract.contractCode}}),t._v(" "),a("field-item",{attrs:{label:"合同类型",content:t.pageData.singleContract.contractTypeName}})],1)],1):t.pageData.projectInfo?a("panel",{attrs:{title:"项目信息"}},[a("card",[a("field-item",{attrs:{label:"交易主体",content:t.pageData.corporationName}}),t._v(" "),a("field-item",{attrs:{label:"合作方",content:t.pageData.projectInfo.partnerName}}),t._v(" "),a("field-item",{attrs:{label:"项目编号",content:t.pageData.projectInfo.projectCode}}),t._v(" "),a("field-item",{attrs:{label:"项目类型",content:t.pageData.projectInfo.projectTypeName}})],1)],1):a("card",[a("field-item",{attrs:{label:"交易主体",content:t.pageData.corporationName}})],1),t._v(" "),a("panel",{attrs:{title:"风险提示"}},[a("card",t._l(t.pageData.payExtra,function(t){return a("field-item",{key:t.name,attrs:{label:t.name,content:t.value}})}))],1),t._v(" "),t.pageData.checkHistory.length>0?a("panel",{attrs:{title:"审核历史记录",type:"link",href:{path:"/"+t.moduleName+"/"+t.actionName+"/history",query:{detail_id:t.pageData.detailId}}}}):t._e(),t._v(" "),"detail"!=t.actionName?[t.pageData.auditOptions?a("panel",{attrs:{title:"本次审核意见"}},[t._l(t.pageData.auditOptions,function(e,n){return a("card",{key:e.name},[a("error-focus",{model:{value:t.auditError[n],callback:function(e){t.$set(t.auditError,n,e)},expression:"auditError[index]"}},[a("audit-item",{attrs:{title:n+1+"."+e.name,value:t.audit[n].value},on:{input:function(e){t.auditInput(n,"value",e)}}})],1),t._v(" "),a("error-focus",{model:{value:t.auditError[n],callback:function(e){t.$set(t.auditError,n,e)},expression:"auditError[index]"}},[a("audit-item",{attrs:{type:"input",value:t.audit[n].comment},on:{input:function(e){t.auditInput(n,"comment",e)}}})],1)],1)}),t._v(" "),a("card",{attrs:{topBorder:1}},[a("error-focus",{model:{value:t.auditCommentError,callback:function(e){t.auditCommentError=e},expression:"auditCommentError"}},[a("audit-item",{attrs:{type:"comment",placeholder:"请输入本次审核意见"},model:{value:t.auditComment,callback:function(e){t.auditComment=e},expression:"auditComment"}})],1)],1)],2):t._e(),t._v(" "),a("submit-btn",{attrs:{okText:"通过",cancelText:"驳回"},on:{okHandle:function(e){t.onSubmit("1")},cancelHandle:function(e){t.onSubmit("-1")}}})]:t._e()],2):t._e()};N._withStripped=!0;var I={render:N,staticRenderFns:[]},w=I;var T=!1;var E=a("VU/8")(k,w,!1,function(t){T||a("AdLt")},"data-v-e12f972a",null);E.options.__file="src\\router\\check13\\check13.vue";e.default=E.exports},rQ8G:function(t,e,a){(t.exports=a("FZ+f")(!0)).push([t.i,"\n@-webkit-keyframes twinkling-data-v-776eb880{\n0%{\n      /* border: 2px solid transparent; */\n      background-color: transparent;\n}\n100%{\n      background-color: rgba(255,196,196, 0.1);\n        /* border-color: rgba(#ff0000, 0.8); */\n}\n}\n@keyframes twinkling-data-v-776eb880{\n0%{\n      /* border: 2px solid transparent; */\n      background-color: transparent;\n}\n100%{\n      background-color: rgba(255,196,196, 0.1);\n        /* border-color: rgba(#ff0000, 0.8); */\n}\n}\n.error-focus[data-v-776eb880]{\n  position: relative;\n}\n.error[data-v-776eb880]:after{\n    content: '';\n    position: absolute;\n    left: 0;\n    top: 0;\n    width: 100%;\n    height: 100%;\n    -webkit-animation: twinkling-data-v-776eb880 .3s 3 ease-in-out;\n            animation: twinkling-data-v-776eb880 .3s 3 ease-in-out;\n}\n","",{version:3,sources:["C:/Users/alaba/codes/oil_new/protected/h5/src/components/src/components/ErrorFocus.vue","C:/Users/alaba/codes/oil_new/protected/h5/src/components/<no source>"],names:[],mappings:";AA+BA;AACA;MACA,oCAAA;MACA,8BAAA;CACA;AACA;MCpCA,yCAAA;QDsCA,uCAAA;CACA;CACA;AATA;AACA;MACA,oCAAA;MACA,8BAAA;CACA;AACA;MCpCA,yCAAA;QDsCA,uCAAA;CACA;CACA;AACA;EACA,mBAAA;CACA;AAEA;IACA,YAAA;IACA,mBAAA;IACA,QAAA;IACA,OAAA;IACA,YAAA;IACA,aAAA;IACA,+DAAA;YAAA,uDAAA;CACA",file:"ErrorFocus.vue",sourcesContent:["<template>\r\n  <div class=\"error-focus\" :class=\"{error: value}\">\r\n    <slot></slot>\r\n  </div>\r\n</template>\r\n<script>\r\nexport default {\r\n  props: {\r\n    value: {\r\n      default: false\r\n    }\r\n  },\r\n  data () {\r\n    return {\r\n    }\r\n  },\r\n  watch: {\r\n    value (v) {\r\n      if (!window.__errorFocus && v) {\r\n        window.__errorFocus = true\r\n        this.$el.scrollIntoView()\r\n        clearTimeout(this.timer)\r\n        this.timer = setTimeout(() => {\r\n          this.$emit('input', false)\r\n          window.__errorFocus = false\r\n        }, 1000)\r\n      }\r\n    }\r\n  }\r\n}\r\n<\/script>\r\n<style scoped>\r\n @keyframes twinkling{\r\n    0%{\r\n      /* border: 2px solid transparent; */\r\n      background-color: transparent;\r\n    }\r\n    100%{\r\n      background-color: rgba(#ffc4c4, 0.1);\r\n        /* border-color: rgba(#ff0000, 0.8); */\r\n    }\r\n}\r\n.error-focus{\r\n  position: relative;\r\n}\r\n.error{\r\n  &:after{\r\n    content: '';\r\n    position: absolute;\r\n    left: 0;\r\n    top: 0;\r\n    width: 100%;\r\n    height: 100%;\r\n    animation: twinkling .3s 3 ease-in-out;\r\n  }\r\n}\r\n</style>\r\n",null],sourceRoot:""}])},sDsX:function(t,e,a){var n=a("hkk0");"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);a("rjj0")("736f5b25",n,!1)},shcg:function(t,e,a){(t.exports=a("FZ+f")(!0)).push([t.i,"\n.flex-1[data-v-696330a7]{\r\n  -webkit-box-flex: 1;\r\n  -webkit-flex: 1;\r\n          flex: 1;\n}\n.table-split[data-v-696330a7]{\r\nmargin-top: 15px;\n}\n.simple-card h1[data-v-696330a7]{\r\n    font-weight: normal; \r\n    font-size: 14px;\n}\n.simple-card p[data-v-696330a7]{\r\n    font-size: 12px;\r\n    color: #949494;\n}\n.quota-item[data-v-696330a7]{\r\n  display: -webkit-box;\r\n  display: -webkit-flex;\r\n  display: flex;\r\n  font-size: 14px;\n}\n.quota-item .quota-info[data-v-696330a7]{\r\n    padding: 0 10px;\n}\n.quota-item .quota-info p[data-v-696330a7]{\r\n      padding: 3px 0;\n}\n.simple-formula[data-v-696330a7] {\r\n  font-size: 14px;\r\n  overflow: hidden;\r\n  font-family: Microsoft YaHei,'\\5B8B\\4F53' ,'Source Sans Pro', 'Helvetica Neue', Helvetica, Arial, sans-serif;\n}\r\n","",{version:3,sources:["C:/Users/alaba/codes/oil_new/protected/h5/src/router/check/src/router/check/check.vue"],names:[],mappings:";AAgQA;EACA,oBAAA;EAAA,gBAAA;UAAA,QAAA;CACA;AACA;AACA,iBAAA;CACA;AAEA;IACA,oBAAA;IACA,gBAAA;CACA;AACA;IACA,gBAAA;IACA,eAAA;CACA;AAEA;EACA,qBAAA;EAAA,sBAAA;EAAA,cAAA;EACA,gBAAA;CAOA;AANA;IACA,gBAAA;CAIA;AAHA;MACA,eAAA;CACA;AAGA;EACA,gBAAA;EACA,iBAAA;EACA,6GAAA;CACA",file:"check.vue",sourcesContent:['<template>\r\n  <div v-if="pageData">\r\n     <panel title="项目信息">\r\n       <card>\r\n          <field-item label="项目编码" :content="pageData.projectCode" />\r\n          <field-item label="项目类型" :content="pageData.projectTypeName" />\r\n          <field-item label="购销信息" :content="pageData.buySellDesc" />\r\n          <field-item label="合同类型" :content="pageData.contractTypeName" />\r\n          <field-item label="代理模式" :content="pageData.agentTypeName" />\r\n          <div class="g-dotted-split" v-if="pageData.agentName || pageData.prevParterName"></div>\r\n          <field-item label="采购代理商" :content="pageData.agentName" />\r\n          <field-item label="上游合作方" :content="pageData.prevPartnerName" />\r\n          <field-item label="下游合作方" :content="pageData.nextPartnerName" />\r\n          <div class="g-dotted-split" ></div>\r\n          <field-item label="交易主体" :content="pageData.corporationName" />\r\n       </card>\r\n     </panel>\r\n     <panel title="交易明细"  type="link" :href="{path:\'/\'+moduleName+\'/\'+actionName+\'/goods\', query: {id}}" >\r\n       <card v-for="good in goods" v-if="good.name" :key="good.id">\r\n          <audit-goods-item :name="good.name" :avatar="good.avatar" :blue="good.type==\'2\'" :quantity="good.quantityName" :price="good.price" />\r\n       </card>\r\n     </panel>\r\n     <panel title="计价公式" v-if="pageData.buyFormula || pageData.sellFormula">\r\n       <card class="simple-card" v-if="pageData.buyFormula && pageData.buyContract && pageData.buyContract.price_type == 2">\r\n         <h1>采购计价公式</h1>\r\n         <p>{{pageData.buyFormula}}</p>\r\n       </card>\r\n       <card class="simple-card" v-if="pageData.sellFormula && pageData.sellContract && pageData.sellContract.price_type == 2">\r\n         <h1>销售计价公式</h1>\r\n         <p>{{pageData.sellFormula}}</p>\r\n       </card>\r\n     </panel>\r\n     </panel>\r\n     <panel type="link" title="合同条款" v-if="contractTitle" :href="{path:\'/\'+moduleName+\'/\'+actionName+\'/contract\', query: {id}}" />\r\n     <panel type="link" title="代理手续费" v-if="pageData.agentDetails.length" :href="{path:\'/\'+moduleName+\'/\'+actionName+\'/agentfee\', query: {id}}" />\r\n     <panel title="收付款计划" v-if="contractTitle">\r\n        <card>\r\n            <audit-table avatar="付" v-if="pageData.prevPayments">\r\n              <template slot="header">\r\n                  <td width="80">预计时间</td>\r\n                  <td width="100">付款类别</td>\r\n                  <td>金额</td>\r\n                  <td width="50">备注</td>\r\n              </template>\r\n              <template slot="body">\r\n                <tr v-for="item in pageData.prevPayments">\r\n                  <td>{{item.date}}</td>\r\n                  <td>{{item.typeName}}</td>\r\n                  <td>{{item.price}}</td>\r\n                  <td>\r\n                    <action-modal :value="item.remark"></action-modal>\r\n                  </td>\r\n                </tr>\r\n               </template>\r\n            </audit-table>\r\n            <audit-table class="table-split" avatar="收" :blue="true" v-if="pageData.nextPayments">\r\n              <template slot="header">\r\n                  <td width="80">预计时间</td>\r\n                  <td width="100">收款类别</td>\r\n                  <td>金额</td>\r\n                  <td width="50">备注</td>\r\n              </template>\r\n              <template slot="body">\r\n                <tr v-for="item in pageData.nextPayments">\r\n                  <td>{{item.date}}</td>\r\n                  <td>{{item.typeName}}</td>\r\n                  <td>{{item.price}}</td>\r\n                  <td>\r\n                    <action-modal :value="item.remark"></action-modal>\r\n                  </td>\r\n                </tr>\r\n               </template>\r\n            </audit-table>\r\n            <div class="g-dotted-split" ></div>\r\n            <div v-if="pageData.attachments">\r\n              <field-item v-if="actionName===\'check\'" type="link" :href="{path:\'/\'+moduleName+\'/\'+actionName+\'/attachment\', query: {id}}" label="项目预算表" content="查看" />\r\n              <field-item v-if="actionName===\'detail\'" type="link" :href="{path:\'/\'+moduleName+\'/\'+actionName+\'/attachment\', query: {detail_id: pageData.detailId}}" label="项目预算表" content="查看" />\r\n            </div>\r\n        </card>\r\n    </panel>\r\n    <panel title="创建人信息">\r\n       <card >\r\n          <field-item label="创建人" :content="pageData.creator" />\r\n          <field-item label="创建时间" :content="pageData.create_time" />\r\n          <field-item label="修改人" :content="pageData.updater" />\r\n          <field-item label="修改时间" :content="pageData.update_time" />\r\n       </card>\r\n    </panel>\r\n    <panel title="额度管理" v-if="pageData.quotas.length">\r\n       <card v-for="item in pageData.quotas" :key="item.id">\r\n         <div class="quota-item">\r\n          <text-avatar :blue="item.isBlue">{{item.icon}}</text-avatar>\r\n          <div class="quota-info">\r\n            <p>占用对象： {{item.name}}</p>\r\n            <p>占用金额： {{item.price}}</p>\r\n            <p>备注： {{item.comment || \'无\'}}</p>\r\n          </div>\r\n         </div>\r\n       </card>\r\n    </panel>\r\n    <panel v-if="pageData.checkHistory.length" title="审核历史记录" type="link" :href="{path:\'/\'+moduleName+\'/\'+actionName+\'/history\', query: {detail_id: pageData.detailId}}"></panel>\r\n    <template v-if="moduleName==\'check2\' && actionName==\'check\'">\r\n    <panel title="额度管理">\r\n      <card>\r\n         <error-focus v-model="audit1Error">\r\n            <audit-item title="是否启用额度流程" v-model="audit1" />\r\n         </error-focus>\r\n      </card>\r\n    </panel>\r\n    </template>\r\n    <panel v-if="actionName!=\'detail\'" title="本次审核意见">\r\n      <card :topBorder="1" >\r\n        <error-focus v-model="audit2Error">\r\n          <audit-item type="comment" placeholder="请输入本次审核意见" v-model="audit2"/>\r\n        </error-focus>\r\n      </card>\r\n    </panel>\r\n    <submit-btn v-if="actionName!=\'detail\'" okText="通过" cancelText="驳回" @okHandle="onSubmit(\'1\')" @cancelHandle="onSubmit(\'-1\')"/>\r\n  </div>\r\n  <div v-else>\r\n\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { Indicator, MessageBox } from \'mint-ui\'\r\nimport Panel from \'@/components/Panel\'\r\nimport Card from \'@/components/Card\'\r\nimport FieldItem from \'@/components/FieldItem\'\r\nimport AuditItem from \'@/components/AuditItem\'\r\nimport AuditGoodsItem from \'@/components/AuditGoodsItem\'\r\nimport AuditTable from \'@/components/AuditTable\'\r\nimport SubmitBtn from \'@/components/SubmitBtn\'\r\nimport ErrorFocus from \'@/components/ErrorFocus\'\r\nimport ActionModal from \'@/components/ActionModal\'\r\nimport Inline from \'@/components/Inline\'\r\nimport TextAvatar from \'@/components/TextAvatar\'\r\nimport mapVmodel, {mapBase, mapStatePlus} from \'@/utils/mapVmodel\'\r\nimport {post} from \'@/utils/request\'\r\n\r\nexport default {\r\n  components: {\r\n    Panel,\r\n    Card,\r\n    AuditItem,\r\n    FieldItem,\r\n    AuditGoodsItem,\r\n    AuditTable,\r\n    SubmitBtn,\r\n    ErrorFocus,\r\n    ActionModal,\r\n    Inline,\r\n    TextAvatar\r\n  },\r\n  data () {\r\n    return {\r\n      audit1Error: false,\r\n      audit2Error: false\r\n    }\r\n  },\r\n  computed: {\r\n    ...mapBase(),\r\n    ...mapVmodel({moduleName: true}, [\'audit1\'], [\'audit1comment\'], [\'audit2\']),\r\n    ...mapStatePlus(\'pageData\'),\r\n    id () {\r\n      return this.pageData ? this.pageData.contractId : \'\'\r\n    },\r\n    goods () {\r\n      let {pageData} = this\r\n      let goods = []\r\n      if (pageData) {\r\n        if (pageData.buyGoods) {\r\n          goods = goods.concat(pageData.buyGoods)\r\n        }\r\n        if (pageData.sellGoods) {\r\n          goods = goods.concat(pageData.sellGoods)\r\n        }\r\n      }\r\n      return goods\r\n    },\r\n    contractTitle () {\r\n      let {pageData} = this\r\n      let prefix = \'\'\r\n      if (pageData.buyContent) {\r\n        prefix += \'上\'\r\n      }\r\n      if (pageData.sellContent) {\r\n        prefix += \'下\'\r\n      }\r\n      if (!prefix) {\r\n        return \'\'\r\n      }\r\n      return prefix + \'游\'\r\n    }\r\n  },\r\n  watch: {\r\n    pageData () {\r\n      document.title = this.pageData.pageTitle || \'石油系统\'\r\n    }\r\n  },\r\n  methods: {\r\n    async onSubmit (status) {\r\n      // 风控审核\r\n      let {moduleName, actionName} = this\r\n      if (actionName === \'check\') {\r\n        if (moduleName === \'check2\' && !this.audit1 && status === \'1\') {\r\n          this.audit1Error = Date.now()\r\n          this.$toptips(\'请选择是否启用额度流程\')\r\n        } else if (!this.audit2) {\r\n          this.audit2Error = Date.now()\r\n          this.$toptips(\'请输入本次审核意见\')\r\n        } else {\r\n          let confirmText = status === \'1\' ? \'通过\' : \'驳回\'\r\n          let action = await MessageBox.confirm(`确定要${confirmText}本次审核吗？`, \'\').catch(() => (false))\r\n          if (action) {\r\n            Indicator.open()\r\n            let {success, msg} = await post(`/${moduleName}/save`, {\r\n              obj: {\r\n                remark: this.audit2,\r\n                check_id: this.pageData.checkId,\r\n                checkStatus: status\r\n              }\r\n            })\r\n\r\n            if (success) {\r\n              var res2 = {success: 1}\r\n              if (status === \'1\' && this.audit1 === \'0\') {\r\n                res2 = await post(`/quota/save`, {\r\n                  contract_id: this.pageData.contractId,\r\n                  project_id: this.pageData.projectId,\r\n                  is_main: this.pageData.isMain\r\n                })\r\n              }\r\n\r\n              Indicator.close()\r\n              await MessageBox.alert(\'审核提交成功!\', \'\')\r\n              if (status === \'1\' && (this.audit1 === \'1\' || !res2.success)) {\r\n                if (this.audit1 === \'0\' && !res2.success) { await MessageBox.alert(res2.msg, \'\') }\r\n\r\n                this.$router.replace({path: `/${moduleName}/${actionName}/add-price`, query: {id: this.pageData.contractId, detail_id: this.pageData.detailId}})\r\n              } else {\r\n                this.$router.replace({path: `/${moduleName}/detail`, query: {detail_id: this.pageData.detailId, __force: true}})\r\n              }\r\n            } else {\r\n              await MessageBox.alert(msg, \'\').then(action => {\r\n                window.location.href = \'/site/index\'\r\n              })\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n<\/script>\r\n\r\n<style scoped>\r\n.flex-1{\r\n  flex: 1;\r\n}\r\n.table-split{\r\nmargin-top: 15px;\r\n}\r\n.simple-card{\r\n  h1{\r\n    font-weight: normal; \r\n    font-size: 14px;\r\n  }\r\n  p{\r\n    font-size: 12px;\r\n    color: #949494;\r\n  }\r\n}\r\n.quota-item{\r\n  display: flex;\r\n  font-size: 14px;\r\n  .quota-info{\r\n    padding: 0 10px;\r\n    p{\r\n      padding: 3px 0;\r\n    }\r\n  }\r\n}\r\n.simple-formula {\r\n  font-size: 14px;\r\n  overflow: hidden;\r\n  font-family: Microsoft YaHei,\'宋体\' ,\'Source Sans Pro\', \'Helvetica Neue\', Helvetica, Arial, sans-serif;\r\n}\r\n</style>\r\n'],sourceRoot:""}])},vHKS:function(t,e,a){var n=a("z17N");"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);a("rjj0")("a97161e2",n,!1)},z17N:function(t,e,a){(t.exports=a("FZ+f")(!0)).push([t.i,"\n.g-inline-field-item{\r\n  display: -webkit-box;\r\n  display: -webkit-flex;\r\n  display: flex;\n}\n.g-inline-field-item section {\r\n    -webkit-box-flex: 1;\r\n    -webkit-flex: 1;\r\n            flex: 1;\r\n    padding-right: 10px!important;\n}\r\n","",{version:3,sources:["C:/Users/alaba/codes/oil_new/protected/h5/src/components/src/components/Inline.vue"],names:[],mappings:";AAOA;EACA,qBAAA;EAAA,sBAAA;EAAA,cAAA;CAKA;AAJA;IACA,oBAAA;IAAA,gBAAA;YAAA,QAAA;IACA,8BAAA;CACA",file:"Inline.vue",sourcesContent:['<template>\r\n<div class="g-inline-field-item"><slot /></div>\r\n</template>\r\n<script>\r\nexport default {\r\n}\r\n<\/script>\r\n<style>\r\n.g-inline-field-item{\r\n  display: flex;\r\n  section {\r\n    flex: 1;\r\n    padding-right: 10px!important;\r\n  }\r\n}\r\n</style>\r\n'],sourceRoot:""}])}});
//# sourceMappingURL=1.ae7c864237b5b1bb55fb.js.map